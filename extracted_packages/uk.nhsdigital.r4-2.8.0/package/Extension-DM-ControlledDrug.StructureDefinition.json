{"resourceType":"StructureDefinition","id":"51c8f867-9fa0-4ca8-a82f-0f76d06d3bc2","url":"https://fhir.nhs.uk/StructureDefinition/Extension-DM-ControlledDrug","name":"ExtensionDMControlledDrug","status":"draft","fhirVersion":"4.0.1","mapping":[{"identity":"rim","uri":"http://hl7.org/v3","name":"RIM Mapping"}],"kind":"complex-type","abstract":false,"context":[{"type":"element","expression":"MedicationRequest"}],"type":"Extension","baseDefinition":"http://hl7.org/fhir/StructureDefinition/Extension","derivation":"constraint","differential":{"element":[{"id":"Extension","path":"Extension","constraint":[{"key":"eps-cd1","severity":"error","human":"Extension(controlledDrug) - For schedule 2 or 3 Controlled Drugs, the quantity must be expressed in words","expression":"(((extension('schedule').value.code='CD2' and extension('quantityWords').exists()) or (extension('schedule').value.code='CD3' and extension('quantityWords').exists()) or (extension('schedule').value.code != 'CD2' and extension('schedule').value.code != 'CD3')) and extension('scheduled').exists()) or (extension('scheduled').exists().not())"}]},{"id":"Extension.extension","path":"Extension.extension","slicing":{"discriminator":[{"type":"value","path":"url"}],"rules":"open"},"min":0},{"id":"Extension.extension:quantityWords","path":"Extension.extension","sliceName":"quantityWords","min":0,"max":"1"},{"id":"Extension.extension:quantityWords.url","path":"Extension.extension.url","fixedUri":"quantityWords"},{"id":"Extension.extension:quantityWords.value[x]","path":"Extension.extension.value[x]","min":1,"type":[{"code":"string"}]},{"id":"Extension.extension:schedule","path":"Extension.extension","sliceName":"schedule","min":0,"max":"1","binding":{"strength":"required","valueSet":"https://fhir.nhs.uk/ValueSet/DM-medicationrequest-controlled-drug"}},{"id":"Extension.extension:schedule.url","path":"Extension.extension.url","fixedUri":"schedule"},{"id":"Extension.extension:schedule.value[x]","path":"Extension.extension.value[x]","min":1,"type":[{"code":"Coding"}]},{"id":"Extension.extension:schedule.value[x].system","path":"Extension.extension.value[x].system","min":1},{"id":"Extension.extension:schedule.value[x].code","path":"Extension.extension.value[x].code","min":1},{"id":"Extension.extension:schedule.value[x].display","path":"Extension.extension.value[x].display","min":1},{"id":"Extension.url","path":"Extension.url","fixedUri":"https://fhir.nhs.uk/StructureDefinition/Extension-DM-ControlledDrug"},{"id":"Extension.value[x]","path":"Extension.value[x]","max":"0"}]}}